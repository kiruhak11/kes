# Руководство по миграции характеристик товаров

## Обзор изменений

Проект был успешно обновлен для работы с новым форматом характеристик товаров. Теперь характеристики хранятся как массив объектов с полями `id`, `key` и `value` вместо старого формата объекта.

## Новый формат характеристик

### Старый формат (больше не используется):
```json
{
  "Марка": "Котел КВр 0.23",
  "Вид топки": "Ручная, Колосники, ОУР",
  "Мощность": "0.23 МВт"
}
```

### Новый формат:
```json
[
  {
    "id": 1,
    "key": "Марка",
    "value": "Котел КВр 0.23"
  },
  {
    "id": 2,
    "key": "Вид топки",
    "value": "Ручная, Колосники, ОУР"
  },
  {
    "id": 3,
    "key": "Мощность",
    "value": "0.23 МВт"
  }
]
```

## Новые возможности

### 1. Drag & Drop для изменения порядка характеристик

В админ-панели теперь доступна возможность перетаскивания характеристик для изменения их порядка:

- **В форме создания товара**: Перетаскивайте строки характеристик за иконку ⋮⋮ в первой колонке
- **В форме редактирования товара**: Аналогично перетаскивайте строки для изменения порядка
- **Визуальная обратная связь**: При перетаскивании строка становится полупрозрачной и поворачивается

### 2. Улучшенная работа с характеристиками

- Характеристики теперь имеют уникальные ID
- Порядок характеристик сохраняется
- Автоматическое обновление ID при изменении порядка

## Технические изменения

### API Endpoints

1. **GET /api/products** - Возвращает характеристики в новом формате
2. **POST /api/products** - Принимает характеристики в новом формате
3. **PUT /api/products/{id}** - Обновляет характеристики в новом формате

### Компоненты

1. **AdminCatalog.vue** - Добавлена drag & drop функциональность
2. **Страницы каталога** - Обновлены для работы с новым форматом
3. **Страница товара** - Обновлена для отображения характеристик

### Утилиты

1. **utils/characteristics.ts** - Обновлены функции для работы с новым форматом
2. **Типы TypeScript** - Обновлены интерфейсы

## Использование

### Создание товара с характеристиками

1. Откройте админ-панель
2. Заполните основную информацию о товаре
3. В разделе "Характеристики":
   - Добавьте характеристики через поля "Параметр" и "Значение"
   - Используйте drag & drop для изменения порядка
   - Используйте быстрые подсказки для заполнения
4. Сохраните товар

### Редактирование характеристик

1. Откройте товар для редактирования
2. В разделе "Характеристики":
   - Измените параметры и значения
   - Перетащите строки для изменения порядка
   - Добавьте новые характеристики
   - Удалите ненужные характеристики
3. Сохраните изменения

## Совместимость

- Все существующие товары автоматически конвертированы в новый формат
- Обратная совместимость обеспечена через функции конвертации
- API поддерживает оба формата для плавной миграции

## Преимущества нового формата

1. **Упорядоченность**: Характеристики имеют четкий порядок
2. **Гибкость**: Легко добавлять, удалять и изменять характеристики
3. **Drag & Drop**: Интуитивное изменение порядка
4. **Типизация**: Лучшая поддержка TypeScript
5. **Масштабируемость**: Легко добавлять новые поля в будущем

## Поддержка

При возникновении проблем:

1. Проверьте консоль браузера на наличие ошибок
2. Убедитесь, что все API endpoints работают корректно
3. Проверьте, что база данных содержит данные в новом формате
4. Обратитесь к разработчику при необходимости

---

**Дата обновления**: Декабрь 2024  
**Версия**: 2.0.0 